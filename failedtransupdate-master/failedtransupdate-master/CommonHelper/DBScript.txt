--EMAIL
CREATE TABLE [dbo].[GOK_EMAILPUSH_LOGS](
	[ID] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[MOBILENO] [varchar](20) NULL,
	[CHANNEL] [varchar](10) NULL,
	[DEPARTMENT] [varchar](20) NULL,
	[MAILTO] [varchar](512) NULL,
	[MAILCC] [varchar](512) NULL,
	[MAILBCC] [varchar](512) NULL,
	[SUBJECT] [nvarchar](1024) NULL,
	[BODY] [nvarchar](max) NULL,
	[ATTACHMENT] [varchar](512) NULL,
	[LOGDATE] [datetime] NULL,
	[TRANSDATE] [datetime] NULL,
 CONSTRAINT [PK_GOK_EMAILPUSH_LOGS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

ALTER TABLE [dbo].[GOK_EMAILPUSH_LOGS] ADD  CONSTRAINT [DF_GOK_EMAILPUSH_LOGS_TRANSDATE]  DEFAULT (getdate()) FOR [TRANSDATE]
GO


CREATE NONCLUSTERED INDEX [IDX_GOK_EMAILPUSH_LOGS_1] ON [dbo].[GOK_EMAILPUSH_LOGS]
(
	[MOBILENO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX [IDX_GOK_EMAILPUSH_LOGS_2] ON [dbo].[GOK_EMAILPUSH_LOGS]
(
	[TRANSDATE] ASC,
	[MOBILENO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

CREATE PROCEDURE [dbo].[GOK_EMAILPUSH_LOGS_CURD]
(
@MOBILENO VARCHAR(20)=NULL,
@CHANNEL VARCHAR(10)=NULL,
@DEPARTMENT VARCHAR(20)=NULL,
@MAILTO VARCHAR(512)=NULL,
@MAILCC VARCHAR(512)=NULL,
@MAILBCC VARCHAR(512)=NULL,
@SUBJECT NVARCHAR(2048)=NULL,
@BODY NVARCHAR(MAX)=NULL,
@ATTACHMENT VARCHAR(512)=NULL,
@LOGDATE DATETIME=NULL,
@TYPE VARCHAR(10),
@RETSTATUS VARCHAR(20)=NULL OUT
)
AS
BEGIN
	SET NOCOUNT ON;
	IF(@TYPE='C')
	BEGIN
		INSERT INTO GOK_EMAILPUSH_LOGS (MOBILENO,CHANNEL,DEPARTMENT,MAILTO,MAILCC,MAILBCC,[SUBJECT],BODY,ATTACHMENT,LOGDATE)
		VALUES(@MOBILENO,@CHANNEL,@DEPARTMENT,@MAILTO,@MAILCC,@MAILBCC,@SUBJECT,@BODY,@ATTACHMENT,@LOGDATE)

		IF @@ERROR<>0
			SET @RETSTATUS = 1;
		ELSE
			SET @RETSTATUS = @@IDENTITY;
	END
END
GO


--SMS
CREATE TABLE [dbo].[GOK_SMSPUSH_LOGS](
	[ID] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[MOBILENO] [varchar](20) NULL,
	[CHANNEL] [varchar](10) NULL,
	[DEPARTMENT] [varchar](20) NULL,
	[SENDERID] [varchar](20) NULL,
	[MESSAGE] [nvarchar](2048) NULL,
	[LOGDATE] [datetime] NULL,
	[TRANSDATE] [datetime] NULL,
	[REQUEST] [nvarchar](2048) NULL,
	[RESPONSE] [nvarchar](2048) NULL,
 CONSTRAINT [PK_GOK_SMSPUSH_LOGS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

ALTER TABLE [dbo].[GOK_SMSPUSH_LOGS] ADD  CONSTRAINT [DF_Table_1_TRANSDATE]  DEFAULT (getdate()) FOR [TRANSDATE]
GO

CREATE NONCLUSTERED INDEX [IDX_GOK_SMSPUSH_LOGS_1] ON [dbo].[GOK_SMSPUSH_LOGS]
(
	[MOBILENO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX [IDX_GOK_SMSPUSH_LOGS_2] ON [dbo].[GOK_SMSPUSH_LOGS]
(
	[TRANSDATE] ASC,
	[MOBILENO] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO

CREATE PROCEDURE [dbo].[GOK_SMSPUSH_LOGS_CURD]
(
@MOBILENO VARCHAR(20)=NULL,
@CHANNEL VARCHAR(10)=NULL,
@DEPARTMENT VARCHAR(20)=NULL,
@SENDERID VARCHAR(20)=NULL,
@MESSAGE NVARCHAR(2048)=NULL,
@LOGDATE DATETIME=NULL,
@REQUEST NVARCHAR(2048)=NULL,
@RESPONSE NVARCHAR(2048)=NULL,
@TYPE VARCHAR(10),
@RETSTATUS VARCHAR(20)=NULL OUT
)
AS
BEGIN
	SET NOCOUNT ON;
	IF(@TYPE='C')
	BEGIN
		INSERT INTO GOK_SMSPUSH_LOGS (MOBILENO,CHANNEL,DEPARTMENT,SENDERID,[MESSAGE],LOGDATE,REQUEST,RESPONSE)
		VALUES(@MOBILENO,@CHANNEL,@DEPARTMENT,@SENDERID,@MESSAGE,@LOGDATE,@REQUEST,@RESPONSE)

		IF @@ERROR<>0
			SET @RETSTATUS = 1;
		ELSE
			SET @RETSTATUS = @@IDENTITY;
	END
END
GO