USE [GOT_TRANS]
GO
/****** Object:  Table [dbo].[TappTransactionList]    Script Date: 3/13/2018 2:47:02 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[TappTransactionList](
	[ID] [numeric](18, 0) IDENTITY(1,1) NOT NULL,
	[ApplicationNumber] [varchar](50) NULL,
	[Service] [varchar](100) NULL,
	[TransactionID] [varchar](50) NOT NULL,
	[CreatedBy] [varchar](50) NULL,
	[TransactionDate] [datetime] NULL,
	[TransactionAmount] [varchar](50) NULL,
 CONSTRAINT [PK_TappTransactionList] PRIMARY KEY CLUSTERED 
(
	[TransactionID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
SET ANSI_PADDING OFF
GO

/****** Object:  StoredProcedure [dbo].[UDP_TAPP_TRANS_CRUD]    Script Date: 3/13/2018 2:36:00 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROC [dbo].[UDP_TAPP_TRANS_CRUD]          
(          
 @APPLICATIONNUMBER  VARCHAR(50)=NULL,          
 @SERVICE   VARCHAR(100)=NULL,          
 @TRANSACTIONID   VARCHAR(50)=NULL,          
 @CREATEDBY   VARCHAR(50)=NULL,          
 @TRANSACTIONDATE   VARCHAR(50)=NULL,          
 @TRANSACTIONAMOUNT   VARCHAR(50)=NULL,          
 @RETVALUE    INT OUT          
)          
/*          
 CREATED BY: ANIL KUMAR K        
         ON: 22-NOV-2017          
    PURPOSE: To insert the Tapp trans insert into table      
*/         
AS          
BEGIN          
     INSERT INTO TAPPTRANSACTIONLIST
			    (
				APPLICATIONNUMBER,
				[SERVICE],
				TRANSACTIONID,
				CREATEDBY,
				TRANSACTIONDATE,
				TRANSACTIONAMOUNT
				)
		VALUES
				(
				@APPLICATIONNUMBER,
				@SERVICE,
				@TRANSACTIONID,
				@CREATEDBY,
				@TRANSACTIONDATE,
				@TRANSACTIONAMOUNT
				)

		SET @RETVALUE=1;
END



USE [GOT]
GO
/****** Object:  StoredProcedure [dbo].[PAYMENT_TRANS_BY_TRANSDATEnSERVICE_GET]    Script Date: 3/13/2018 2:38:34 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[PAYMENT_TRANS_BY_TRANSDATEnSERVICE_GET]
(
@FROMDATE VARCHAR(50)=NULL,
@TODATE VARCHAR(50)=NULL,
@MODE VARCHAR(50)='TRANS',
@SERVICE VARCHAR(50)=NULL
)
AS
BEGIN
	SET NOCOUNT ON
	IF(@MODE='TRANS')
		SELECT 
			[DESCRIPTION],
			TRANSID,
			TRANSDATE,
			DEPTTRANSID,
			AMOUNT,
			CONSUMERNUMBER,
			ESEVATRANSID 
		FROM PAYMENT_TRANS(NOLOCK) 
		WHERE CONVERT(DATE,TRANSDATE) BETWEEN @FROMDATE AND @TODATE AND [SERVICE]=@SERVICE AND [Status]=1;
	ELSE IF(@MODE='COUNT')
		SELECT 
			COUNT(*) AS 'COUNT',
			SUM(AMOUNT) AS 'TOTALAMOUNT' 
		FROM PAYMENT_TRANS(NOLOCK) 
		WHERE CONVERT(DATE,TRANSDATE) BETWEEN @FROMDATE AND @TODATE AND [SERVICE]=@SERVICE AND [Status]=1
END

